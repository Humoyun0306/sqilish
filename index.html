<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Тоска — Путь к покою</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300&family=Jost:wght@200;300;400;500&display=swap" rel="stylesheet" />
  <script defer src="https://cloud.umami.is/script.js" data-website-id="e982095e-d1d9-4ceb-a5fa-5c075811fe89"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #050505;
      --white: #ffffff;
      --emerald: #34d399;
      --glass: rgba(255,255,255,0.04);
      --border: rgba(255,255,255,0.08);
    }

    ::selection { background: rgba(52, 211, 153, 0.25); }

    html, body {
      height: 100%;
      background: var(--bg);
      color: var(--white);
      font-family: 'Jost', sans-serif;
      font-weight: 300;
      overflow: hidden;
    }

    .bg-blobs {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
    }

    .blob {
      position: absolute;
      border-radius: 50%;
      filter: blur(120px);
    }

    .blob-1 {
      top: -10%;
      left: -10%;
      width: 40%;
      height: 40%;
      background: rgba(6, 78, 59, 0.22);
      animation: pulse-blob 8s ease-in-out infinite;
    }

    .blob-2 {
      bottom: -10%;
      right: -10%;
      width: 50%;
      height: 50%;
      background: rgba(49, 46, 129, 0.18);
      animation: pulse-blob 12s ease-in-out infinite reverse;
    }

    .noise {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      opacity: 0.18;
      mix-blend-mode: overlay;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    }

    @keyframes pulse-blob {
      0%, 100% { transform: scale(1); opacity: 0.8; }
      50% { transform: scale(1.15); opacity: 1; }
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(24px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeSlideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    @keyframes breathe {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.7; }
    }

    #app {
      position: relative;
      z-index: 2;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem 2.5rem;
      flex-shrink: 0;
    }

    .logo {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.5rem;
      font-weight: 300;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      animation: fadeSlideIn 0.6s ease both;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .icon-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--white);
      padding: 0.5rem;
      border-radius: 50%;
      opacity: 0.65;
      transition: opacity 0.2s, background 0.2s;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-family: 'Jost', sans-serif;
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
    }

    .icon-btn:hover { opacity: 1; background: rgba(255,255,255,0.05); }
    .icon-btn svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 1.5; }

    .close-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      font-size: 1rem;
      font-weight: 500;
      line-height: 1;
      justify-content: center;
    }

    main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
      text-align: center;
    }

    .step {
      display: none;
      flex-direction: column;
      align-items: center;
      max-width: 700px;
      width: 100%;
      animation: fadeUp 0.7s ease both;
    }

    .step.active { display: flex; }

    .landing-h1 {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(2.8rem, 8vw, 5.5rem);
      font-weight: 300;
      line-height: 1.1;
      background: linear-gradient(180deg, #fff 0%, rgba(255,255,255,0.4) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1.5rem;
    }

    .landing-p {
      font-size: 1.1rem;
      color: rgba(255,255,255,0.55);
      line-height: 1.8;
      max-width: 560px;
      margin-bottom: 2.5rem;
    }

    .cta-btn {
      padding: 1rem 2.5rem;
      background: var(--white);
      color: #000;
      border: none;
      border-radius: 100px;
      font-family: 'Jost', sans-serif;
      font-size: 1.05rem;
      font-weight: 500;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .cta-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 32px rgba(255,255,255,0.25);
    }

    .visualizer {
      position: relative;
      width: 220px;
      height: 220px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 2rem;
    }

    .ring {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      border: 1px solid rgba(255,255,255,0.18);
      animation: ring-pulse 4s ease-in-out infinite;
    }

    .ring-outer {
      inset: -20px;
      border-color: rgba(255,255,255,0.07);
      animation-duration: 6s;
      animation-direction: reverse;
    }

    @keyframes ring-pulse {
      0%, 100% { transform: scale(1); opacity: 0.4; }
      50% { transform: scale(1.2); opacity: 0.9; }
    }

    .timer {
      font-family: 'Cormorant Garamond', serif;
      font-size: 3.5rem;
      font-weight: 300;
      letter-spacing: 0.1em;
    }

    .phrase-wrap {
      min-height: 7rem;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.5rem;
    }

    .phrase {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(1.3rem, 3vw, 1.9rem);
      font-style: italic;
      font-weight: 300;
      line-height: 1.6;
      color: rgba(255,255,255,0.8);
      max-width: 560px;
      transition: opacity 0.8s ease, transform 0.8s ease;
    }

    .phrase.hidden { opacity: 0; transform: translateY(-10px); }

    .instruction {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.3em;
      color: rgba(255,255,255,0.28);
      animation: breathe 3s ease-in-out infinite;
    }

    .heart-icon {
      width: 64px;
      height: 64px;
      color: var(--emerald);
      margin-bottom: 1.5rem;
    }

    .finished-h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(2rem, 5vw, 3rem);
      font-weight: 300;
      margin-bottom: 1rem;
    }

    .finished-p {
      font-size: 1.1rem;
      color: rgba(255,255,255,0.55);
      margin-bottom: 2rem;
    }

    .outline-btn {
      padding: 0.7rem 2rem;
      background: none;
      border: 1px solid rgba(255,255,255,0.2);
      color: var(--white);
      border-radius: 100px;
      font-family: 'Jost', sans-serif;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
    }

    .outline-btn:hover { background: var(--white); color: #000; }

    footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 1.5rem 2.5rem;
      display: flex;
      justify-content: flex-start;
      align-items: flex-end;
      z-index: 50;
    }

    .guide-btn {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--white);
      font-family: 'Jost', sans-serif;
      font-size: 0.7rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      opacity: 0.4;
      transition: opacity 0.2s;
    }

    .guide-btn:hover { opacity: 1; }
    .guide-btn svg { width: 14px; height: 14px; stroke: currentColor; fill: none; stroke-width: 1.5; }

    .modal-overlay {
      position: fixed;
      inset: 0;
      z-index: 100;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
      background: rgba(0,0,0,0.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    .modal-overlay.open { display: flex; }

    .modal-box {
      background: #111;
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 2rem;
      padding: 2.5rem 3rem;
      position: relative;
      width: 100%;
      max-width: 540px;
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal-close {
      position: absolute;
      top: 1.2rem;
      right: 1.4rem;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--white);
      font-size: 1.1rem;
      opacity: 0.4;
      transition: opacity 0.2s;
    }

    .modal-close:hover { opacity: 1; }

    .modal-h {
      font-family: 'Cormorant Garamond', serif;
      font-size: 2rem;
      font-weight: 300;
      margin-bottom: 1rem;
    }

    .modal-p {
      color: rgba(255,255,255,0.55);
      line-height: 1.8;
      margin-bottom: 1.5rem;
    }

    .guide-item {
      display: flex;
      gap: 1rem;
      padding: 1rem 1.2rem;
      background: rgba(255,255,255,0.04);
      border-radius: 1rem;
      align-items: flex-start;
    }

    .guide-item-icon {
      padding: 0.5rem;
      background: rgba(52,211,153,0.15);
      border-radius: 0.5rem;
      display: flex;
      flex-shrink: 0;
    }

    .guide-item-icon svg { width: 18px; height: 18px; stroke: var(--emerald); fill: none; stroke-width: 1.5; }
    .guide-item-title { font-size: 0.95rem; font-weight: 400; margin-bottom: 0.2rem; }
    .guide-item-sub { font-size: 0.8rem; color: rgba(255,255,255,0.4); }

    @media (max-width: 640px) {
      header { padding: 1rem 1.25rem; }
      footer { padding: 1rem 1.25rem; }
      .modal-box { padding: 1.5rem; }
    }
  </style>
</head>
<body>
  <div class="bg-blobs">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
  </div>
  <div class="noise"></div>

  <div id="app">
    <header>
      <div class="logo" id="logo">Тоска</div>
      <div class="header-actions">
        <button class="icon-btn" id="lang-btn" onclick="toggleLang()">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
          <span id="lang-label">ru</span>
        </button>
        <button class="icon-btn" id="mute-btn" style="display:none" onclick="toggleMute()">
          <svg id="vol-icon" viewBox="0 0 24 24"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>
        </button>
        <button class="icon-btn close-btn" id="close-btn" onclick="closeSession()" aria-label="close">✕</button>
      </div>
    </header>

    <main>
      <div class="step active" id="step-landing">
        <h1 class="landing-h1" id="landing-h1"></h1>
        <p class="landing-p" id="landing-p"></p>
        <button class="cta-btn" id="cta-btn" onclick="startSession()"></button>
      </div>

      <div class="step" id="step-session">
        <div class="visualizer">
          <div class="ring ring-outer"></div>
          <div class="ring"></div>
          <div class="timer" id="timer">3:00</div>
        </div>
        <div class="phrase-wrap">
          <p class="phrase" id="phrase"></p>
        </div>
        <p class="instruction" id="instruction"></p>
      </div>

      <div class="step" id="step-finished">
        <svg class="heart-icon" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" fill="none">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
        </svg>
        <h2 class="finished-h2" id="finished-h2"></h2>
        <p class="finished-p" id="finished-p"></p>
        <button class="outline-btn" id="restart-btn" onclick="restart()"></button>
      </div>
    </main>

    <footer>
      <button class="guide-btn" onclick="openGuide()">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
        <span id="guide-btn-label">Как это работает?</span>
      </button>
    </footer>
  </div>

  <div class="modal-overlay" id="guide-modal">
    <div class="modal-box">
      <button class="modal-close" onclick="closeGuide()">✕</button>
      <h3 class="modal-h" id="guide-title"></h3>
      <p class="modal-p" id="guide-text"></p>
      <div class="guide-item">
        <div class="guide-item-icon">
          <svg viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
        </div>
        <div>
          <div class="guide-item-title" id="guide-item-title"></div>
          <div class="guide-item-sub" id="guide-item-sub"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SESSION_SECONDS = 180;
    const FREQUENCY_HZ = 432;

    const translations = {
      ru: {
        title: "Тоска",
        subtitle: "Чувствуете грусть без причины? Ничего не радует? Мы поможем вам. Просто побудьте с нами 3 минуты, и мы вернем вам вкус к жизни.",
        cta: "Да, начнем ☹️",
        guideTitle: "Как это работает?",
        guideBtnLabel: "Как это работает?",
        guideText: "Этот сайт создан для того, чтобы помочь вам пережить тяжелое состояние. Просто заходите сюда один раз в день и дышите спокойно вместе с нами.",
        guideItemTitle: "Один раз в день",
        guideItemSub: "Достаточно 3 минут, чтобы стабилизировать состояние.",
        phrases: [
          "Слушайте звук внимательнее. Частота Гц помогает замедлиться и успокоить мысли.",
          "Если сейчас тяжело, это не навсегда. Дайте себе время и мягкий ритм дыхания.",
          "Вы уже делаете важный шаг к себе. Спокойствие постепенно возвращается."
        ],
        finalMessage: "Вы справились. Почувствуйте, как стало легче. Возвращайтесь завтра.",
        instruction: "Наденьте наушники для лучшего эффекта.",
        restart: "Вернуться в начало"
      },
      en: {
        title: "Melancholy",
        subtitle: "Feeling down for no reason? Nothing feels right? We can help. Stay with us for 3 minutes and breathe.",
        cta: "Yes, let's start ☹️",
        guideTitle: "How it works?",
        guideBtnLabel: "How it works?",
        guideText: "This site helps you ease overwhelming emotions. Visit once a day, follow the breathing pace, and stay present.",
        guideItemTitle: "Once a day",
        guideItemSub: "Just 3 minutes can rebalance your mood.",
        phrases: [
          "Listen closely. Hz is used to create a calmer and softer sound field.",
          "If today feels heavy, let this moment hold you. Slow breathing helps your body settle.",
          "You are already doing something good for yourself. Calm can return step by step."
        ],
        finalMessage: "You did it. Feel how much lighter you are. Come back tomorrow.",
        instruction: "Wear headphones for the best experience.",
        restart: "Back to start"
      }
    };

    let lang = 'ru';
    let timeLeft = SESSION_SECONDS;
    let timerInterval = null;
    let isMuted = false;
    let currentPhraseIdx = -1;

    let audioCtx = null;
    let oscillator = null;
    let gainNode = null;

    function startAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }

      oscillator = audioCtx.createOscillator();
      gainNode = audioCtx.createGain();
      oscillator.type = 'sine';
      oscillator.frequency.setValueAtTime(FREQUENCY_HZ, audioCtx.currentTime);
      gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
      gainNode.gain.linearRampToValueAtTime(0.1, audioCtx.currentTime + 2);
      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);
      oscillator.start();
    }

    function stopAudio() {
      if (!audioCtx || !gainNode || !oscillator) return;
      gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.7);
      setTimeout(() => {
        try { oscillator.stop(); } catch (e) {}
        oscillator.disconnect();
        gainNode.disconnect();
        oscillator = null;
        gainNode = null;
      }, 700);
    }

    function toggleMute() {
      if (!gainNode || !audioCtx) return;
      isMuted = !isMuted;
      const target = isMuted ? 0 : 0.1;
      gainNode.gain.linearRampToValueAtTime(target, audioCtx.currentTime + 0.3);
      const icon = document.getElementById('vol-icon');
      icon.innerHTML = isMuted
        ? '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/>'
        : '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>';
    }

    function toggleLang() {
      lang = lang === 'ru' ? 'en' : 'ru';
      renderTranslations();
    }

    function renderTranslations() {
      const t = translations[lang];
      document.getElementById('lang-label').textContent = lang;
      document.getElementById('logo').textContent = t.title;

      const parts = t.subtitle.split('?');
      document.getElementById('landing-h1').textContent = (parts[0] || t.title) + '?';
      document.getElementById('landing-p').textContent = parts.slice(1).join('?').trim();
      document.getElementById('cta-btn').textContent = t.cta;

      document.getElementById('guide-title').textContent = t.guideTitle;
      document.getElementById('guide-btn-label').textContent = t.guideBtnLabel;
      document.getElementById('guide-text').textContent = t.guideText;
      document.getElementById('guide-item-title').textContent = t.guideItemTitle;
      document.getElementById('guide-item-sub').textContent = t.guideItemSub;

      document.getElementById('instruction').textContent = t.instruction;
      document.getElementById('restart-btn').textContent = t.restart;
      updatePhrase(true);

      const [first, ...rest] = t.finalMessage.split('.');
      document.getElementById('finished-h2').textContent = first.trim() + '.';
      document.getElementById('finished-p').textContent = rest.join('.').trim();
    }

    function showStep(stepName) {
      document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
      document.getElementById('step-' + stepName).classList.add('active');
    }

    function startSession() {
      timeLeft = SESSION_SECONDS;
      currentPhraseIdx = -1;
      isMuted = false;
      document.getElementById('mute-btn').style.display = 'flex';
      showStep('session');
      updateTimer();
      updatePhrase(true);
      startAudio();
      clearInterval(timerInterval);
      timerInterval = setInterval(tick, 1000);
    }

    function finishSession() {
      clearInterval(timerInterval);
      timerInterval = null;
      document.getElementById('mute-btn').style.display = 'none';
      stopAudio();
      showStep('finished');
      renderTranslations();
    }

    function closeSession() {
      clearInterval(timerInterval);
      timerInterval = null;
      document.getElementById('mute-btn').style.display = 'none';
      stopAudio();
      timeLeft = SESSION_SECONDS;
      updateTimer();
      showStep('landing');
    }

    function tick() {
      timeLeft -= 1;
      updateTimer();
      updatePhrase(false);
      if (timeLeft <= 0) {
        finishSession();
      }
    }

    function updateTimer() {
      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      document.getElementById('timer').textContent = `${minutes}:${String(seconds).padStart(2, '0')}`;
    }

    function updatePhrase(force) {
      const t = translations[lang];
      const idx = Math.min(Math.floor((SESSION_SECONDS - timeLeft) / 60), t.phrases.length - 1);
      if (!force && idx === currentPhraseIdx) return;

      currentPhraseIdx = idx;
      const el = document.getElementById('phrase');
      el.classList.add('hidden');
      setTimeout(() => {
        el.textContent = t.phrases[idx];
        el.classList.remove('hidden');
      }, 300);
    }

    function restart() {
      closeSession();
    }

    function openGuide() {
      document.getElementById('guide-modal').classList.add('open');
    }

    function closeGuide() {
      document.getElementById('guide-modal').classList.remove('open');
    }

    document.getElementById('guide-modal').addEventListener('click', function (e) {
      if (e.target === this) closeGuide();
    });

    renderTranslations();
    updateTimer();
  </script>
</body>
</html>

